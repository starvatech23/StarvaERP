{"dependencies":[{"name":"./RedBlackTree","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":44,"index":44}}],"key":"bUbSMDsveoPcNryAEpmgb3mT4bg=","exportNames":["*"],"imports":1}},{"name":"./Diagram","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":45},"end":{"line":2,"column":44,"index":89}}],"key":"diR0nWZ39JTO8rCc8rRmUhGc1LY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"firstCircle\", {\n    enumerable: true,\n    get: function () {\n      return firstCircle;\n    }\n  });\n  exports.attachCircle = attachCircle;\n  exports.detachCircle = detachCircle;\n  var _RedBlackTree = require(_dependencyMap[0], \"./RedBlackTree\");\n  var _Diagram = require(_dependencyMap[1], \"./Diagram\");\n  var circlePool = [];\n  var firstCircle;\n  function Circle() {\n    (0, _RedBlackTree.RedBlackNode)(this);\n    this.x = this.y = this.arc = this.site = this.cy = null;\n  }\n  function attachCircle(arc) {\n    var lArc = arc.P,\n      rArc = arc.N;\n    if (!lArc || !rArc) return;\n    var lSite = lArc.site,\n      cSite = arc.site,\n      rSite = rArc.site;\n    if (lSite === rSite) return;\n    var bx = cSite[0],\n      by = cSite[1],\n      ax = lSite[0] - bx,\n      ay = lSite[1] - by,\n      cx = rSite[0] - bx,\n      cy = rSite[1] - by;\n    var d = 2 * (ax * cy - ay * cx);\n    if (d >= -_Diagram.epsilon2) return;\n    var ha = ax * ax + ay * ay,\n      hc = cx * cx + cy * cy,\n      x = (cy * ha - ay * hc) / d,\n      y = (ax * hc - cx * ha) / d;\n    var circle = circlePool.pop() || new Circle();\n    circle.arc = arc;\n    circle.site = cSite;\n    circle.x = x + bx;\n    circle.y = (circle.cy = y + by) + Math.sqrt(x * x + y * y); // y bottom\n\n    arc.circle = circle;\n    var before = null,\n      node = _Diagram.circles._;\n    while (node) {\n      if (circle.y < node.y || circle.y === node.y && circle.x <= node.x) {\n        if (node.L) node = node.L;else {\n          before = node.P;\n          break;\n        }\n      } else {\n        if (node.R) node = node.R;else {\n          before = node;\n          break;\n        }\n      }\n    }\n    _Diagram.circles.insert(before, circle);\n    if (!before) firstCircle = circle;\n  }\n  function detachCircle(arc) {\n    var circle = arc.circle;\n    if (circle) {\n      if (!circle.P) firstCircle = circle.N;\n      _Diagram.circles.remove(circle);\n      circlePool.push(circle);\n      (0, _RedBlackTree.RedBlackNode)(circle);\n      arc.circle = null;\n    }\n  }\n});","lineCount":78,"map":[[7,2,6,0,"Object"],[7,8,6,0],[7,9,6,0,"defineProperty"],[7,23,6,0],[7,24,6,0,"exports"],[7,31,6,0],[8,4,6,0,"enumerable"],[8,14,6,0],[9,4,6,0,"get"],[9,7,6,0],[9,18,6,0,"get"],[9,19,6,0],[10,6,6,0],[10,13,6,0,"firstCircle"],[10,24,6,0],[11,4,6,0],[12,2,6,0],[13,2,17,0,"exports"],[13,9,17,0],[13,10,17,0,"attachCircle"],[13,22,17,0],[13,25,17,0,"attachCircle"],[13,37,17,0],[14,2,69,0,"exports"],[14,9,69,0],[14,10,69,0,"detachCircle"],[14,22,69,0],[14,25,69,0,"detachCircle"],[14,37,69,0],[15,2,1,0],[15,6,1,0,"_RedBlackTree"],[15,19,1,0],[15,22,1,0,"require"],[15,29,1,0],[15,30,1,0,"_dependencyMap"],[15,44,1,0],[16,2,2,0],[16,6,2,0,"_Diagram"],[16,14,2,0],[16,17,2,0,"require"],[16,24,2,0],[16,25,2,0,"_dependencyMap"],[16,39,2,0],[17,2,4,0],[17,6,4,4,"circlePool"],[17,16,4,14],[17,19,4,17],[17,21,4,19],[18,2,6,7],[18,6,6,11,"firstCircle"],[18,17,6,22],[19,2,8,0],[19,11,8,9,"Circle"],[19,17,8,15,"Circle"],[19,18,8,15],[19,20,8,18],[20,4,9,2],[20,8,9,2,"RedBlackNode"],[20,21,9,14],[20,22,9,14,"RedBlackNode"],[20,34,9,14],[20,36,9,15],[20,40,9,19],[20,41,9,20],[21,4,10,2],[21,8,10,6],[21,9,10,7,"x"],[21,10,10,8],[21,13,11,2],[21,17,11,6],[21,18,11,7,"y"],[21,19,11,8],[21,22,12,2],[21,26,12,6],[21,27,12,7,"arc"],[21,30,12,10],[21,33,13,2],[21,37,13,6],[21,38,13,7,"site"],[21,42,13,11],[21,45,14,2],[21,49,14,6],[21,50,14,7,"cy"],[21,52,14,9],[21,55,14,12],[21,59,14,16],[22,2,15,0],[23,2,17,7],[23,11,17,16,"attachCircle"],[23,23,17,28,"attachCircle"],[23,24,17,29,"arc"],[23,27,17,32],[23,29,17,34],[24,4,18,2],[24,8,18,6,"lArc"],[24,12,18,10],[24,15,18,13,"arc"],[24,18,18,16],[24,19,18,17,"P"],[24,20,18,18],[25,6,19,6,"rArc"],[25,10,19,10],[25,13,19,13,"arc"],[25,16,19,16],[25,17,19,17,"N"],[25,18,19,18],[26,4,21,2],[26,8,21,6],[26,9,21,7,"lArc"],[26,13,21,11],[26,17,21,15],[26,18,21,16,"rArc"],[26,22,21,20],[26,24,21,22],[27,4,23,2],[27,8,23,6,"lSite"],[27,13,23,11],[27,16,23,14,"lArc"],[27,20,23,18],[27,21,23,19,"site"],[27,25,23,23],[28,6,24,6,"cSite"],[28,11,24,11],[28,14,24,14,"arc"],[28,17,24,17],[28,18,24,18,"site"],[28,22,24,22],[29,6,25,6,"rSite"],[29,11,25,11],[29,14,25,14,"rArc"],[29,18,25,18],[29,19,25,19,"site"],[29,23,25,23],[30,4,27,2],[30,8,27,6,"lSite"],[30,13,27,11],[30,18,27,16,"rSite"],[30,23,27,21],[30,25,27,23],[31,4,29,2],[31,8,29,6,"bx"],[31,10,29,8],[31,13,29,11,"cSite"],[31,18,29,16],[31,19,29,17],[31,20,29,18],[31,21,29,19],[32,6,30,6,"by"],[32,8,30,8],[32,11,30,11,"cSite"],[32,16,30,16],[32,17,30,17],[32,18,30,18],[32,19,30,19],[33,6,31,6,"ax"],[33,8,31,8],[33,11,31,11,"lSite"],[33,16,31,16],[33,17,31,17],[33,18,31,18],[33,19,31,19],[33,22,31,22,"bx"],[33,24,31,24],[34,6,32,6,"ay"],[34,8,32,8],[34,11,32,11,"lSite"],[34,16,32,16],[34,17,32,17],[34,18,32,18],[34,19,32,19],[34,22,32,22,"by"],[34,24,32,24],[35,6,33,6,"cx"],[35,8,33,8],[35,11,33,11,"rSite"],[35,16,33,16],[35,17,33,17],[35,18,33,18],[35,19,33,19],[35,22,33,22,"bx"],[35,24,33,24],[36,6,34,6,"cy"],[36,8,34,8],[36,11,34,11,"rSite"],[36,16,34,16],[36,17,34,17],[36,18,34,18],[36,19,34,19],[36,22,34,22,"by"],[36,24,34,24],[37,4,36,2],[37,8,36,6,"d"],[37,9,36,7],[37,12,36,10],[37,13,36,11],[37,17,36,15,"ax"],[37,19,36,17],[37,22,36,20,"cy"],[37,24,36,22],[37,27,36,25,"ay"],[37,29,36,27],[37,32,36,30,"cx"],[37,34,36,32],[37,35,36,33],[38,4,37,2],[38,8,37,6,"d"],[38,9,37,7],[38,13,37,11],[38,14,37,12,"epsilon2"],[38,22,37,20],[38,23,37,20,"epsilon2"],[38,31,37,20],[38,33,37,22],[39,4,39,2],[39,8,39,6,"ha"],[39,10,39,8],[39,13,39,11,"ax"],[39,15,39,13],[39,18,39,16,"ax"],[39,20,39,18],[39,23,39,21,"ay"],[39,25,39,23],[39,28,39,26,"ay"],[39,30,39,28],[40,6,40,6,"hc"],[40,8,40,8],[40,11,40,11,"cx"],[40,13,40,13],[40,16,40,16,"cx"],[40,18,40,18],[40,21,40,21,"cy"],[40,23,40,23],[40,26,40,26,"cy"],[40,28,40,28],[41,6,41,6,"x"],[41,7,41,7],[41,10,41,10],[41,11,41,11,"cy"],[41,13,41,13],[41,16,41,16,"ha"],[41,18,41,18],[41,21,41,21,"ay"],[41,23,41,23],[41,26,41,26,"hc"],[41,28,41,28],[41,32,41,32,"d"],[41,33,41,33],[42,6,42,6,"y"],[42,7,42,7],[42,10,42,10],[42,11,42,11,"ax"],[42,13,42,13],[42,16,42,16,"hc"],[42,18,42,18],[42,21,42,21,"cx"],[42,23,42,23],[42,26,42,26,"ha"],[42,28,42,28],[42,32,42,32,"d"],[42,33,42,33],[43,4,44,2],[43,8,44,6,"circle"],[43,14,44,12],[43,17,44,15,"circlePool"],[43,27,44,25],[43,28,44,26,"pop"],[43,31,44,29],[43,32,44,30],[43,33,44,31],[43,37,44,35],[43,41,44,39,"Circle"],[43,47,44,45],[43,48,44,44],[43,49,44,45],[44,4,45,2,"circle"],[44,10,45,8],[44,11,45,9,"arc"],[44,14,45,12],[44,17,45,15,"arc"],[44,20,45,18],[45,4,46,2,"circle"],[45,10,46,8],[45,11,46,9,"site"],[45,15,46,13],[45,18,46,16,"cSite"],[45,23,46,21],[46,4,47,2,"circle"],[46,10,47,8],[46,11,47,9,"x"],[46,12,47,10],[46,15,47,13,"x"],[46,16,47,14],[46,19,47,17,"bx"],[46,21,47,19],[47,4,48,2,"circle"],[47,10,48,8],[47,11,48,9,"y"],[47,12,48,10],[47,15,48,13],[47,16,48,14,"circle"],[47,22,48,20],[47,23,48,21,"cy"],[47,25,48,23],[47,28,48,26,"y"],[47,29,48,27],[47,32,48,30,"by"],[47,34,48,32],[47,38,48,36,"Math"],[47,42,48,40],[47,43,48,41,"sqrt"],[47,47,48,45],[47,48,48,46,"x"],[47,49,48,47],[47,52,48,50,"x"],[47,53,48,51],[47,56,48,54,"y"],[47,57,48,55],[47,60,48,58,"y"],[47,61,48,59],[47,62,48,60],[47,63,48,61],[47,64,48,62],[49,4,50,2,"arc"],[49,7,50,5],[49,8,50,6,"circle"],[49,14,50,12],[49,17,50,15,"circle"],[49,23,50,21],[50,4,52,2],[50,8,52,6,"before"],[50,14,52,12],[50,17,52,15],[50,21,52,19],[51,6,53,6,"node"],[51,10,53,10],[51,13,53,13,"circles"],[51,21,53,20],[51,22,53,20,"circles"],[51,29,53,20],[51,30,53,21,"_"],[51,31,53,22],[52,4,55,2],[52,11,55,9,"node"],[52,15,55,13],[52,17,55,15],[53,6,56,4],[53,10,56,8,"circle"],[53,16,56,14],[53,17,56,15,"y"],[53,18,56,16],[53,21,56,19,"node"],[53,25,56,23],[53,26,56,24,"y"],[53,27,56,25],[53,31,56,30,"circle"],[53,37,56,36],[53,38,56,37,"y"],[53,39,56,38],[53,44,56,43,"node"],[53,48,56,47],[53,49,56,48,"y"],[53,50,56,49],[53,54,56,53,"circle"],[53,60,56,59],[53,61,56,60,"x"],[53,62,56,61],[53,66,56,65,"node"],[53,70,56,69],[53,71,56,70,"x"],[53,72,56,72],[53,74,56,74],[54,8,57,6],[54,12,57,10,"node"],[54,16,57,14],[54,17,57,15,"L"],[54,18,57,16],[54,20,57,18,"node"],[54,24,57,22],[54,27,57,25,"node"],[54,31,57,29],[54,32,57,30,"L"],[54,33,57,31],[54,34,57,32],[54,39,58,11],[55,10,58,13,"before"],[55,16,58,19],[55,19,58,22,"node"],[55,23,58,26],[55,24,58,27,"P"],[55,25,58,28],[56,10,58,30],[57,8,58,37],[58,6,59,4],[58,7,59,5],[58,13,59,11],[59,8,60,6],[59,12,60,10,"node"],[59,16,60,14],[59,17,60,15,"R"],[59,18,60,16],[59,20,60,18,"node"],[59,24,60,22],[59,27,60,25,"node"],[59,31,60,29],[59,32,60,30,"R"],[59,33,60,31],[59,34,60,32],[59,39,61,11],[60,10,61,13,"before"],[60,16,61,19],[60,19,61,22,"node"],[60,23,61,26],[61,10,61,28],[62,8,61,35],[63,6,62,4],[64,4,63,2],[65,4,65,2,"circles"],[65,12,65,9],[65,13,65,9,"circles"],[65,20,65,9],[65,21,65,10,"insert"],[65,27,65,16],[65,28,65,17,"before"],[65,34,65,23],[65,36,65,25,"circle"],[65,42,65,31],[65,43,65,32],[66,4,66,2],[66,8,66,6],[66,9,66,7,"before"],[66,15,66,13],[66,17,66,15,"firstCircle"],[66,28,66,26],[66,31,66,29,"circle"],[66,37,66,35],[67,2,67,0],[68,2,69,7],[68,11,69,16,"detachCircle"],[68,23,69,28,"detachCircle"],[68,24,69,29,"arc"],[68,27,69,32],[68,29,69,34],[69,4,70,2],[69,8,70,6,"circle"],[69,14,70,12],[69,17,70,15,"arc"],[69,20,70,18],[69,21,70,19,"circle"],[69,27,70,25],[70,4,71,2],[70,8,71,6,"circle"],[70,14,71,12],[70,16,71,14],[71,6,72,4],[71,10,72,8],[71,11,72,9,"circle"],[71,17,72,15],[71,18,72,16,"P"],[71,19,72,17],[71,21,72,19,"firstCircle"],[71,32,72,30],[71,35,72,33,"circle"],[71,41,72,39],[71,42,72,40,"N"],[71,43,72,41],[72,6,73,4,"circles"],[72,14,73,11],[72,15,73,11,"circles"],[72,22,73,11],[72,23,73,12,"remove"],[72,29,73,18],[72,30,73,19,"circle"],[72,36,73,25],[72,37,73,26],[73,6,74,4,"circlePool"],[73,16,74,14],[73,17,74,15,"push"],[73,21,74,19],[73,22,74,20,"circle"],[73,28,74,26],[73,29,74,27],[74,6,75,4],[74,10,75,4,"RedBlackNode"],[74,23,75,16],[74,24,75,16,"RedBlackNode"],[74,36,75,16],[74,38,75,17,"circle"],[74,44,75,23],[74,45,75,24],[75,6,76,4,"arc"],[75,9,76,7],[75,10,76,8,"circle"],[75,16,76,14],[75,19,76,17],[75,23,76,21],[76,4,77,2],[77,2,78,0],[78,0,78,1],[78,3]],"functionMap":{"names":["<global>","Circle","attachCircle","detachCircle"],"mappings":"AAA;ACO;CDO;OEE;CFkD;OGE;CHS"},"hasCjsExports":false},"type":"js/module"}]}